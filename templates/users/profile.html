{% extends 'home.html' %}
{% block content %}
<h1>My Profile</h1>
<hr>

<!-- Profile Image -->
<img src="{{ user.profile_image.url }}" width="150" height="150" class="rounded-circle">

<!-- EDIT PROFILE BUTTON (opens modal) -->
<button class="btn btn-warning mt-3" data-bs-toggle="modal" data-bs-target="#editProfileModal">
    Edit Profile
</button>

<hr>

<!-- Profile Details -->
<p><strong>First Name:</strong> {{ user.first_name }}</p>
<p><strong>Last Name:</strong> {{ user.last_name }}</p>
<p><strong>Email:</strong> {{ user.email }}</p>
<p><strong>Phone:</strong> {{ user.phone_number }}</p>
<p><strong>City:</strong> {{ user.city }}</p>
<p><strong>DOB:</strong> {{ user.dob }}</p>
<p><strong>Date Joined:</strong> {{ user.date_joined }}</p>
<p><strong>Last login:</strong> {{ user.last_login }}</p>

# popup model for edit
<div class="modal fade" id="editProfileModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      
      <div class="modal-header">
        <h5 class="modal-title">Edit Profile</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <form method="POST">
        {% csrf_token %}
        
        <div class="modal-body">

          <label>First Name</label>
          <input type="text" name="first_name" value="{{ user.first_name }}" class="form-control mb-2">

          <label>Last Name</label>
          <input type="text" name="last_name" value="{{ user.last_name }}" class="form-control mb-2">
          
          <label>Phone Number</label>
          <input type="text" name="phone_number" value="{{ user.phone_number }}" class="form-control mb-2">

          <label>City</label>
          <input type="text" name="city" value="{{ user.city }}" class="form-control mb-2">

          <label>Date of Birth</label>
          <input type="date" name="dob" value="{{ user.dob|date:'Y-m-d' }}" class="form-control mb-2">

        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-success">Save Changes</button>
        </div>

      </form>

    </div>
  </div>
</div>


<hr>

<!-- UPDATE IMAGE -->
<form action="{% url 'update_profile_image' %}" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="file" name="profile_image" required>
    <button type="submit" class="btn btn-primary mt-2">Update Image</button>
</form>

<!-- DELETE IMAGE -->
<form action="{% url 'delete_profile_image' %}" method="POST">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger mt-2">Delete Profile Image</button>
</form>

{% endblock %}
